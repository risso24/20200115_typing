<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
     <link rel="stylesheet" href="style.css">
    <title>タイピングゲーム</title>
</head>
<body>
       <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>

    <div id="typeGame">
        <div class="button-space"><button @click="getTimer()">ゲームを開始する</button></div>
        <div class="quiz">
            <div class="sub-info">
                <div class="div-level">Level : {{level}}</div>
                <div class="sub-info-present">
                    <div class="div-correct-number">現在の問題正解数：<span v-text="correctCheck"></span>/10</div>
                    <div class="div-timer">残り{{ defaultTimer }}秒</div>
                </div>
            </div>
            <div class="sentence">
                <div class="div-question">{{ questions.quizSentence}}</div>
                <div class="div-type-sentence"><span id="target">{{typedSentence}}</span>{{ currentSentence }}</div>
                <textarea v-model ="typedSentence" @type="correctCheck()"></textarea>
            </div>
        </div>
    </div>
    <script>
    new Vue({
    el: '#typeGame',
    data:{
        correctNumber: 0,
        level : 1,
        defaultTimer:'',
        wpm : 100,
        questions :{
            quizSentence:'私はタイピングゲームを作ります',
            typeSentence: 'watasihataipinguge-muwotukurimasu'
        },
        typedSentence:'',
    },
    computed:{

        currentSentence(){
            const currentTime = new Date().getTime()
            const numberOfTyped = this.typedSentence.length
            const restSentence = this.questions.typeSentence.slice(numberOfTyped)
            return `${restSentence}`
        },
        correctCheck(){   
            const typedText = this.typedSentence.length
            if(this.typedSentence !== this.questions.typeSentence.slice(0, typedText)){
                document.getElementById('target').style.backgroundColor = 'blue'
                document.getElementById('target').style.color = '#fff'
            }else{
                document.getElementById('target').style.backgroundColor = '#fff'
                document.getElementById('target').style.color = 'red'
            }

            //正解したら正解数アップ&10問正解でレベルアップ    
                    if(this.typedSentence === this.questions.typeSentence){
                        this.correctNumber++  
                        this.typedSentence=''
                        if(this.correctNumber >= 10){
                            this.level++
                            this.wpm = this.wpm + 50
                            return this.correctNumber = 0
                            return typedSentence
                        }
                    }
                    return this.correctNumber
                    return this.level
                    return this.wpm 

                    }
    },
    methods: {
        startHand(){
            showQuiz()
        },
            getTimer(){
            const lengthOfSentence = this.questions.typeSentence.length
            if( this.level < 10){
                this.defaultTimer =  (lengthOfSentence*(60/this.wpm)).toFixed(); 
                const countdown = () =>{
                this.defaultTimer--
                const id = setTimeout(countdown, 1000);
            if(this.defaultTimer < 0){　
                this.defaultTimer = 0
                            clearTimeout(id);　//idをclearTimeoutで指定している
            }
        }
                countdown();
             return this.defaultTimer
            }

   
    }
 
                }
            
            }
        )
</script>


</body>
</html>
